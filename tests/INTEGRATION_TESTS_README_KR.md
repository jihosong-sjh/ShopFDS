# Phase 4 í†µí•© í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

**ì‚¬ìš©ì ìŠ¤í† ë¦¬ 2 - ì˜ì‹¬ ê±°ë˜ ì‹œ ë‹¨ê³„ì  ì¸ì¦**

ì´ ë¬¸ì„œëŠ” Phase 4ì—ì„œ êµ¬í˜„í•œ í†µí•© ë° ê²€ì¦ í…ŒìŠ¤íŠ¸(T064-T066)ì— ëŒ€í•œ ìƒì„¸ ê°€ì´ë“œì…ë‹ˆë‹¤.

---

## ğŸ“‹ ê°œìš”

### êµ¬í˜„ ì™„ë£Œëœ í…ŒìŠ¤íŠ¸

| Task ID | í…ŒìŠ¤íŠ¸ íŒŒì¼ | ì„¤ëª… |
|---------|-----------|------|
| T064 | `services/fds/tests/integration/test_medium_risk_scenario.py` | FDS ì¤‘ê°„ ìœ„í—˜ë„ ê±°ë˜ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦ |
| T065 | `services/ecommerce/backend/tests/integration/test_otp_success_scenario.py` | ì¶”ê°€ ì¸ì¦ ì„±ê³µ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦ |
| T066 | `services/ecommerce/backend/tests/integration/test_otp_failure_scenario.py` | ì¶”ê°€ ì¸ì¦ 3íšŒ ì‹¤íŒ¨ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦ |

---

## ğŸ§ª T064: FDS ì¤‘ê°„ ìœ„í—˜ë„ ê±°ë˜ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦

**íŒŒì¼**: `services/fds/tests/integration/test_medium_risk_scenario.py`

### ëª©ì 
FDSê°€ ì¤‘ê°„ ìœ„í—˜ë„(40-70ì ) ê±°ë˜ë¥¼ ì •í™•íˆ íƒì§€í•˜ê³ , ì¶”ê°€ ì¸ì¦ì„ ìš”êµ¬í•˜ëŠ”ì§€ ê²€ì¦í•©ë‹ˆë‹¤.

### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

#### 1. ê³ ì•¡ ê±°ë˜ íƒì§€
```python
test_high_amount_triggers_medium_risk()
```
- **ì…ë ¥**: 500ë§Œì› ê³ ì•¡ ê±°ë˜
- **ê¸°ëŒ€ ê²°ê³¼**:
  - ìœ„í—˜ ì ìˆ˜: 40-70ì 
  - ì˜ì‚¬ê²°ì •: `additional_auth_required`
  - `requires_verification`: True
  - ìœ„í—˜ ìš”ì¸: "ê³ ì•¡ ê±°ë˜ íƒì§€" í¬í•¨

#### 2. ë¹„ì •ìƒ IP íƒì§€
```python
test_unusual_ip_triggers_medium_risk()
```
- **ì…ë ¥**: í•´ì™¸ IP(Tor Exit Node)ì—ì„œ ì ‘ì†
- **ê¸°ëŒ€ ê²°ê³¼**:
  - ìœ„í—˜ ì ìˆ˜: 40-70ì 
  - ì˜ì‚¬ê²°ì •: `additional_auth_required`
  - ìœ„í—˜ ìš”ì¸: "ì§€ì—­ ë¶ˆì¼ì¹˜" í¬í•¨

#### 3. ë°˜ë³µ ê±°ë˜ íƒì§€ (Velocity Check)
```python
test_rapid_transactions_trigger_medium_risk()
```
- **ì…ë ¥**: ë™ì¼ ì‚¬ìš©ìì˜ ì—°ì†ëœ ê±°ë˜ (ë‹¨ì‹œê°„ ë‚´)
- **ê¸°ëŒ€ ê²°ê³¼**:
  - ë‘ ë²ˆì§¸ ê±°ë˜ì˜ ìœ„í—˜ ì ìˆ˜: 40-70ì 
  - ìœ„í—˜ ìš”ì¸: "Velocity check" í¬í•¨

#### 4. ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
```python
test_evaluation_time_within_sla()
```
- **ëª©í‘œ**: FDS í‰ê°€ ì‹œê°„ < 100ms
- **ê²€ì¦**: `evaluation_time_ms < 100`

#### 5. ìœ„í—˜ ìš”ì¸ ìƒì„¸ ê²€ì¦
```python
test_risk_factors_detail()
```
- ê° ìœ„í—˜ ìš”ì¸ì— `factor_type`, `factor_score`, `description` í¬í•¨
- ë³µí•© ìœ„í—˜ ìš”ì¸ ì •í™•í•œ íƒì§€ (ê³ ì•¡ + ë¹„ì •ìƒ IP)

### ì‹¤í–‰ ë°©ë²•
```bash
pytest services/fds/tests/integration/test_medium_risk_scenario.py -v -s
```

### ì˜ˆìƒ ì¶œë ¥
```
âœ“ ê³ ì•¡ ê±°ë˜ ì‹œë‚˜ë¦¬ì˜¤ í†µê³¼: ìœ„í—˜ ì ìˆ˜ 55
âœ“ ë¹„ì •ìƒ IP ì‹œë‚˜ë¦¬ì˜¤ í†µê³¼: ìœ„í—˜ ì ìˆ˜ 60
âœ“ ë°˜ë³µ ê±°ë˜ ì‹œë‚˜ë¦¬ì˜¤ í†µê³¼: ìœ„í—˜ ì ìˆ˜ 65
âœ“ ì„±ëŠ¥ SLA ì¶©ì¡±: 85ms (ëª©í‘œ: <100ms)
âœ“ ìœ„í—˜ ìš”ì¸ ìƒì„¸ ì •ë³´ ê²€ì¦ í†µê³¼
  - íƒì§€ëœ ìœ„í—˜ ìš”ì¸ ìˆ˜: 3
  - ìš”ì¸ 1: amount_threshold (ì ìˆ˜: 40)
  - ìš”ì¸ 2: location_mismatch (ì ìˆ˜: 25)
  - ìš”ì¸ 3: velocity_check (ì ìˆ˜: 20)
```

---

## âœ… T065: ì¶”ê°€ ì¸ì¦ ì„±ê³µ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦

**íŒŒì¼**: `services/ecommerce/backend/tests/integration/test_otp_success_scenario.py`

### ëª©ì 
OTP ì¸ì¦ ì„±ê³µ ì‹œ ì£¼ë¬¸ì´ ì™„ë£Œë˜ê³  ê²°ì œê°€ ì²˜ë¦¬ë˜ëŠ” ì „ì²´ í”Œë¡œìš°ë¥¼ ê²€ì¦í•©ë‹ˆë‹¤.

### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

#### 1. ì „ì²´ OTP ì„±ê³µ í”Œë¡œìš°
```python
test_full_otp_success_flow()
```
**í”Œë¡œìš°**:
1. ê³ ì•¡ ê±°ë˜ ì‹œë„ (450ë§Œì›)
2. FDSê°€ ì¤‘ê°„ ìœ„í—˜ë„ íƒì§€ (ìœ„í—˜ ì ìˆ˜: 55)
3. ì£¼ë¬¸ì€ `PENDING` ìƒíƒœë¡œ ìƒì„±
4. OTP ë°œì†¡
5. ì‚¬ìš©ìê°€ ì˜¬ë°”ë¥¸ OTP ì…ë ¥ (123456)
6. ì£¼ë¬¸ì´ `PAID` ìƒíƒœë¡œ ë³€ê²½
7. ê²°ì œ ì™„ë£Œ ì²˜ë¦¬ (`COMPLETED`)

**ê²€ì¦ í•­ëª©**:
- ì£¼ë¬¸ ìƒíƒœ: `PENDING` â†’ `PAID`
- ê²°ì œ ìƒíƒœ: `PENDING` â†’ `COMPLETED`
- `paid_at` íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë¡
- ê±°ë˜ ID ìƒì„±

#### 2. OTP ë©”íƒ€ë°ì´í„° ê²€ì¦
```python
test_otp_verification_with_correct_order_id()
```
- OTPëŠ” íŠ¹ì • ì£¼ë¬¸ì— ëŒ€í•´ì„œë§Œ ìœ íš¨
- ë‹¤ë¥¸ ì£¼ë¬¸ IDë¡œ ê²€ì¦ ì‹œë„ â†’ ì‹¤íŒ¨
- ì—ëŸ¬ ë©”ì‹œì§€: "OTPê°€ ì´ ì£¼ë¬¸ì— ëŒ€í•œ ê²ƒì´ ì•„ë‹™ë‹ˆë‹¤"

#### 3. ê²°ì œ ìƒíƒœ ì—…ë°ì´íŠ¸ ê²€ì¦
```python
test_otp_success_updates_payment_status()
```
- ê²°ì œ ìƒíƒœ: `PENDING` â†’ `COMPLETED`
- `completed_at` íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë¡
- `transaction_id` ìƒì„± í™•ì¸

#### 4. ì¤‘ë³µ ê²°ì œ ë°©ì§€
```python
test_cannot_complete_already_paid_order()
```
- ì´ë¯¸ `PAID` ìƒíƒœì¸ ì£¼ë¬¸ì€ OTP ì¬ê²€ì¦ ë¶ˆê°€
- ì—ëŸ¬ ë©”ì‹œì§€: "ì´ë¯¸ ê²°ì œê°€ ì™„ë£Œëœ ì£¼ë¬¸ì…ë‹ˆë‹¤"

### ì‹¤í–‰ ë°©ë²•
```bash
pytest services/ecommerce/backend/tests/integration/test_otp_success_scenario.py -v -s
```

### ì˜ˆìƒ ì¶œë ¥
```
âœ“ Step 1: ì£¼ë¬¸ ìƒì„± ì™„ë£Œ (PENDING) - order_id=uuid-xxx
  - ìœ„í—˜ ì ìˆ˜: 55
  - ì¶”ê°€ ì¸ì¦ í•„ìš”: True
âœ“ Step 2: OTP ê²€ì¦ ë° ì£¼ë¬¸ ì™„ë£Œ
  - ìµœì¢… ì£¼ë¬¸ ìƒíƒœ: paid
  - ê²°ì œ ìƒíƒœ: completed
  - ê²°ì œ ì™„ë£Œ ì¼ì‹œ: 2025-11-14 12:34:56

âœ“âœ“âœ“ ì „ì²´ OTP ì„±ê³µ í”Œë¡œìš° í…ŒìŠ¤íŠ¸ í†µê³¼ âœ“âœ“âœ“
âœ“ OTP ì£¼ë¬¸ ID ì¼ì¹˜ ê²€ì¦ í†µê³¼
âœ“ ê²°ì œ ìƒíƒœ ì—…ë°ì´íŠ¸ ê²€ì¦ í†µê³¼
  - ì´ˆê¸°: pending â†’ ìµœì¢…: completed
  - ê±°ë˜ ID: TXN-ORD-20251114-001
âœ“ ì¤‘ë³µ ê²°ì œ ë°©ì§€ ê²€ì¦ í†µê³¼
```

---

## âŒ T066: ì¶”ê°€ ì¸ì¦ 3íšŒ ì‹¤íŒ¨ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦

**íŒŒì¼**: `services/ecommerce/backend/tests/integration/test_otp_failure_scenario.py`

### ëª©ì 
OTP ê²€ì¦ ì‹¤íŒ¨ ì‹œ ì‹œë„ íšŸìˆ˜ ì œí•œ ë° ê±°ë˜ ì°¨ë‹¨ ë¡œì§ì„ ê²€ì¦í•©ë‹ˆë‹¤.

### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

#### 1. ì²« ë²ˆì§¸ OTP ì‹¤íŒ¨
```python
test_otp_first_attempt_failure()
```
- ì˜ëª»ëœ OTP ì…ë ¥ (000000)
- ë‚¨ì€ ì‹œë„ íšŸìˆ˜: 2íšŒ
- ì£¼ë¬¸ ìƒíƒœ: ì—¬ì „íˆ `PENDING`
- ValidationError ë°œìƒ

#### 2. ë‘ ë²ˆì§¸ OTP ì‹¤íŒ¨
```python
test_otp_second_attempt_failure()
```
- ì˜ëª»ëœ OTP ì…ë ¥ (111111)
- ë‚¨ì€ ì‹œë„ íšŸìˆ˜: 1íšŒ (ë§ˆì§€ë§‰ ê¸°íšŒ)
- ê²½ê³  ë©”ì‹œì§€ í¬í•¨

#### 3. ì„¸ ë²ˆì§¸ OTP ì‹¤íŒ¨ - ê±°ë˜ ì°¨ë‹¨
```python
test_otp_third_attempt_failure_blocks_transaction()
```
- ì˜ëª»ëœ OTP ì…ë ¥ (222222)
- ë‚¨ì€ ì‹œë„ íšŸìˆ˜: 0íšŒ
- OTP ì ê¸ˆ ìƒíƒœ
- ì£¼ë¬¸ ìƒíƒœ: `CANCELLED` ë˜ëŠ” `BLOCKED`
- ì—ëŸ¬ ë©”ì‹œì§€: "ìµœëŒ€ ì‹œë„ íšŸìˆ˜ ì´ˆê³¼"

#### 4. ìµœëŒ€ ì‹œë„ ì´ˆê³¼ í›„ ì¬ì‹œë„ ë¶ˆê°€
```python
test_cannot_retry_after_max_attempts()
```
- 3íšŒ ì‹¤íŒ¨ í›„ ë„¤ ë²ˆì§¸ ì‹œë„
- OTP ì ê¸ˆ ìƒíƒœë¡œ ê±°ë¶€
- ì—ëŸ¬ ë©”ì‹œì§€: "OTPê°€ ì ê¸ˆ ìƒíƒœì…ë‹ˆë‹¤. ìƒˆ OTPë¥¼ ë°œê¸‰ë°›ìœ¼ì„¸ìš”."

#### 5. ì£¼ë¬¸ ë…ë¦½ì„± ê²€ì¦
```python
test_otp_failure_does_not_affect_other_orders()
```
- ì£¼ë¬¸ Aì—ì„œ OTP 3íšŒ ì‹¤íŒ¨
- ì£¼ë¬¸ BëŠ” ì—¬ì „íˆ OTP ê²€ì¦ ê°€ëŠ¥
- ë…ë¦½ì ì¸ ì£¼ë¬¸ ì²˜ë¦¬ í™•ì¸

#### 6. ì‹œë„ íšŸìˆ˜ ì •í™•ì„± ê²€ì¦
```python
test_otp_failure_attempt_count_accuracy()
```
- ì‹œë„ íšŸìˆ˜: 3 â†’ 2 â†’ 1 â†’ 0
- ê° ë‹¨ê³„ë³„ ì •í™•í•œ ì¹´ìš´íŠ¸ ê°ì†Œ í™•ì¸

### ì‹¤í–‰ ë°©ë²•
```bash
pytest services/ecommerce/backend/tests/integration/test_otp_failure_scenario.py -v -s
```

### ì˜ˆìƒ ì¶œë ¥
```
âœ“ ì²« ë²ˆì§¸ OTP ì‹¤íŒ¨ ì‹œë‚˜ë¦¬ì˜¤ í†µê³¼ (ë‚¨ì€ ì‹œë„: 2íšŒ)
âœ“ ë‘ ë²ˆì§¸ OTP ì‹¤íŒ¨ ì‹œë‚˜ë¦¬ì˜¤ í†µê³¼ (ë‚¨ì€ ì‹œë„: 1íšŒ, ê²½ê³  ë°œìƒ)
âœ“ ì„¸ ë²ˆì§¸ OTP ì‹¤íŒ¨ ì‹œë‚˜ë¦¬ì˜¤ í†µê³¼ (ê±°ë˜ ì°¨ë‹¨)
âœ“ ìµœëŒ€ ì‹œë„ ì´ˆê³¼ í›„ ì¬ì‹œë„ ì°¨ë‹¨ ê²€ì¦ í†µê³¼
âœ“ ì£¼ë¬¸ ë…ë¦½ì„± ê²€ì¦ í†µê³¼ (ì£¼ë¬¸ A ì‹¤íŒ¨ê°€ ì£¼ë¬¸ Bì— ì˜í–¥ ì—†ìŒ)
âœ“ OTP ì‹œë„ íšŸìˆ˜ ì •í™•ì„± ê²€ì¦ í†µê³¼
  - 1ë²ˆì§¸ ì‹¤íŒ¨: ë‚¨ì€ ì‹œë„ íšŸìˆ˜ 2íšŒ âœ“
  - 2ë²ˆì§¸ ì‹¤íŒ¨: ë‚¨ì€ ì‹œë„ íšŸìˆ˜ 1íšŒ âœ“
  - 3ë²ˆì§¸ ì‹¤íŒ¨: ë‚¨ì€ ì‹œë„ íšŸìˆ˜ 0íšŒ âœ“
```

---

## ğŸš€ ì „ì²´ í†µí•© í…ŒìŠ¤íŠ¸ ì‹¤í–‰

### ìë™ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
```bash
python tests/run_phase4_integration_tests.py
```

ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ”:
1. T064, T065, T066 ìˆœì„œëŒ€ë¡œ ì‹¤í–‰
2. ê° í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì¶œë ¥
3. ìµœì¢… ìš”ì•½ ë¦¬í¬íŠ¸ ìƒì„±

### ì˜ˆìƒ ì¶œë ¥
```
================================================================================
  Phase 4: ì‚¬ìš©ì ìŠ¤í† ë¦¬ 2 - ì˜ì‹¬ ê±°ë˜ ì‹œ ë‹¨ê³„ì  ì¸ì¦
================================================================================

í…ŒìŠ¤íŠ¸ ì‹œì‘ ì‹œê°: 2025-11-14 14:30:00

================================================================================
  T064: FDSì—ì„œ ì¤‘ê°„ ìœ„í—˜ë„ ê±°ë˜ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦ (ìœ„í—˜ ì ìˆ˜ 40-70ì )
================================================================================

[í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë¡œê·¸...]

âœ… T064: FDSì—ì„œ ì¤‘ê°„ ìœ„í—˜ë„ ê±°ë˜ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦ - í†µê³¼

================================================================================
  T065: ì¶”ê°€ ì¸ì¦ ì„±ê³µ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦ (ê±°ë˜ ìŠ¹ì¸)
================================================================================

[í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë¡œê·¸...]

âœ… T065: ì¶”ê°€ ì¸ì¦ ì„±ê³µ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦ - í†µê³¼

================================================================================
  T066: ì¶”ê°€ ì¸ì¦ 3íšŒ ì‹¤íŒ¨ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦ (ê±°ë˜ ì°¨ë‹¨)
================================================================================

[í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë¡œê·¸...]

âœ… T066: ì¶”ê°€ ì¸ì¦ 3íšŒ ì‹¤íŒ¨ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦ - í†µê³¼

================================================================================
  í†µí•© í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½
================================================================================

ì´ í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸: 3ê°œ
âœ… í†µê³¼: 3ê°œ
âŒ ì‹¤íŒ¨: 0ê°œ

1. T064: FDSì—ì„œ ì¤‘ê°„ ìœ„í—˜ë„ ê±°ë˜ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦: âœ… í†µê³¼
2. T065: ì¶”ê°€ ì¸ì¦ ì„±ê³µ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦: âœ… í†µê³¼
3. T066: ì¶”ê°€ ì¸ì¦ 3íšŒ ì‹¤íŒ¨ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦: âœ… í†µê³¼

í…ŒìŠ¤íŠ¸ ì¢…ë£Œ ì‹œê°: 2025-11-14 14:35:42

ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰

  Phase 4 í†µí•© ê²€ì¦ ì™„ë£Œ!
  ì‚¬ìš©ì ìŠ¤í† ë¦¬ 2 - ì˜ì‹¬ ê±°ë˜ ì‹œ ë‹¨ê³„ì  ì¸ì¦ì´ ì •ìƒ ì‘ë™í•©ë‹ˆë‹¤.

ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰

âœ… ì²´í¬í¬ì¸íŠ¸ ë‹¬ì„±:
  - ì‚¬ìš©ì ìŠ¤í† ë¦¬ 1ê³¼ 2ê°€ ëª¨ë‘ ë…ë¦½ì ìœ¼ë¡œ ì‘ë™
  - ì •ìƒ ê±°ë˜ëŠ” ê·¸ëŒ€ë¡œ ì§„í–‰
  - ì˜ì‹¬ ê±°ë˜ëŠ” ì¶”ê°€ ì¸ì¦ì„ ê±°ì¹¨
  - OTP ê²€ì¦ ì„±ê³µ ì‹œ ê±°ë˜ ì™„ë£Œ
  - OTP 3íšŒ ì‹¤íŒ¨ ì‹œ ê±°ë˜ ì°¨ë‹¨
```

---

## ğŸ“Š í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€

### FDS ì„œë¹„ìŠ¤
- âœ… ì¤‘ê°„ ìœ„í—˜ë„ íƒì§€ ë¡œì§
- âœ… ìœ„í—˜ ì ìˆ˜ ê³„ì‚° (40-70ì  ë²”ìœ„)
- âœ… ìœ„í—˜ ìš”ì¸ ì‹ë³„ (ê³ ì•¡, ì§€ì—­, Velocity)
- âœ… ì„±ëŠ¥ SLA (100ms ì´ë‚´)
- âœ… ì˜ì‚¬ê²°ì • ì—”ì§„ (`additional_auth_required`)

### ì´ì»¤ë¨¸ìŠ¤ ì„œë¹„ìŠ¤
- âœ… OTP ë°œì†¡ íŠ¸ë¦¬ê±°
- âœ… OTP ê²€ì¦ ì„±ê³µ í”Œë¡œìš°
- âœ… OTP ê²€ì¦ ì‹¤íŒ¨ í”Œë¡œìš° (1/2/3íšŒ)
- âœ… ì£¼ë¬¸ ìƒíƒœ ì „ì´ (PENDING â†’ PAID)
- âœ… ê²°ì œ ìƒíƒœ ì „ì´ (PENDING â†’ COMPLETED)
- âœ… ì¤‘ë³µ ê²°ì œ ë°©ì§€
- âœ… ì£¼ë¬¸ ë…ë¦½ì„±
- âœ… OTP ì ê¸ˆ ë©”ì»¤ë‹ˆì¦˜

---

## ğŸ”§ í™˜ê²½ ì„¤ì •

### í•„ìˆ˜ ì˜ì¡´ì„±
```bash
pip install pytest pytest-asyncio sqlalchemy aioredis
```

### í™˜ê²½ ë³€ìˆ˜ (.env)
```bash
# ë°ì´í„°ë² ì´ìŠ¤
DATABASE_URL=postgresql+asyncpg://user:pass@localhost:5432/shopfds_test

# Redis
REDIS_URL=redis://localhost:6379/1

# FDS ì„œë¹„ìŠ¤
FDS_SERVICE_URL=http://localhost:8001
FDS_SERVICE_TOKEN=dev-service-token-12345

# OTP ì„¤ì •
OTP_EXPIRY_SECONDS=300
OTP_MAX_ATTEMPTS=3
```

---

## ğŸ› íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì‹œ
1. **ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨**
   ```bash
   # PostgreSQLì´ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸
   docker ps | grep postgres

   # ì—†ìœ¼ë©´ ì‹œì‘
   docker-compose up -d postgres
   ```

2. **Redis ì—°ê²° ì‹¤íŒ¨**
   ```bash
   # Redisê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸
   docker ps | grep redis

   # ì—†ìœ¼ë©´ ì‹œì‘
   docker-compose up -d redis
   ```

3. **ëª¨ë“ˆ ì„í¬íŠ¸ ì—ëŸ¬**
   ```bash
   # PYTHONPATH ì„¤ì •
   export PYTHONPATH="${PYTHONPATH}:$(pwd)"

   # ë˜ëŠ” í”„ë¡œì íŠ¸ ë£¨íŠ¸ì—ì„œ ì‹¤í–‰
   python -m pytest services/fds/tests/integration/...
   ```

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [data-model.md](../specs/001-ecommerce-fds-platform/data-model.md) - ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ
- [fds-contract.md](../specs/001-ecommerce-fds-platform/contracts/fds-contract.md) - FDS API ê³„ì•½
- [tasks.md](../specs/001-ecommerce-fds-platform/tasks.md) - ì „ì²´ íƒœìŠ¤í¬ ëª©ë¡

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

Phase 4 í†µí•© ê²€ì¦ì´ ì™„ë£Œë˜ë©´ ë‹¤ìŒ í•­ëª©ì„ í™•ì¸í•˜ì„¸ìš”:

- [X] T064: FDS ì¤‘ê°„ ìœ„í—˜ë„ ê±°ë˜ íƒì§€
- [X] T065: OTP ì¸ì¦ ì„±ê³µ í”Œë¡œìš°
- [X] T066: OTP ì¸ì¦ ì‹¤íŒ¨ í”Œë¡œìš° (3íšŒ ì œí•œ)
- [X] ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼ (100% success rate)
- [X] ì„±ëŠ¥ SLA ì¶©ì¡± (FDS < 100ms)
- [X] ì‚¬ìš©ì ìŠ¤í† ë¦¬ 1ê³¼ 2 ë…ë¦½ ì‘ë™ í™•ì¸

**ë‹¤ìŒ ë‹¨ê³„**: Phase 5 (ì‚¬ìš©ì ìŠ¤í† ë¦¬ 3 - ê³ ìœ„í—˜ ê±°ë˜ ìë™ ì°¨ë‹¨ ë° ê²€í† )
